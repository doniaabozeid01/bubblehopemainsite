<!-- reset-password.component.html -->
<div class="auth-shell">
  <!-- LEFT: Form -->
  <div class="auth-left">
    <div class="auth-box">

      <div class="brand">
        <div class="brand-text">
          <h1 class="title">{{ 'auth.ResetYourPassword' | translate }}</h1>
          <p class="sub">Set a new password for your account.</p>
        </div>
      </div>

      <!-- Error list -->
      <div *ngIf="errorMessages.length > 0" class="alert alert-danger mb-3" role="alert" aria-live="assertive">
        <ul class="mb-0 small">
          <li *ngFor="let msg of errorMessages">{{ msg }}</li>
        </ul>
      </div>

      <!-- Success -->
      <div *ngIf="successMessage" class="alert alert-success text-center mb-3" role="alert" aria-live="polite">
        {{ successMessage }}
      </div>

      <form [formGroup]="resetForm" (ngSubmit)="onSubmit()" class="form" novalidate>

        <!-- New password -->
        <div class="field mb-0">
          <label class="label" for="newPassword">{{ 'auth.newpassword' | translate }}</label>

          <div class="pwd-wrap">
            <input
              id="newPassword"
              [type]="showPwd ? 'text' : 'password'"
              class="input pe-5"
              formControlName="newPassword"
              placeholder="********"
            />
            <button type="button" class="pwd-toggle" (click)="showPwd = !showPwd" aria-label="Toggle password visibility">
              <span *ngIf="!showPwd"><i class="fa-regular fa-eye"></i></span>
              <span *ngIf="showPwd"><i class="fa-regular fa-eye-slash"></i></span>
            </button>
          </div>

          <div *ngIf="resetForm.get('newPassword')?.touched && resetForm.get('newPassword')?.invalid" class="error mt-2">
            Password doesn't meet the policy below
          </div>

          <!-- لو عندك checklist زي صفحة register استخدميه هنا -->
          <ul class="pwd-help" aria-live="polite">
            <li [class.ok]="rule_hasMinLength">• At least 8 characters</li>
            <li [class.ok]="rule_hasDigit">• At least one number (0–9)</li>
            <li [class.ok]="rule_hasLower">• At least one lowercase letter (a–z)</li>
            <li [class.ok]="rule_hasUpper">• At least one uppercase letter (A–Z)</li>
            <li [class.ok]="rule_hasNonAlnum">• At least one symbol (! @ # $ % …)</li>
          </ul>
        </div>

        <button
          class="btn btn-bg-color w-100 py-1 fs-5 mt-3"
          type="submit"
          [disabled]="resetForm.invalid || loading"
        >
          <ng-container *ngIf="!loading; else loadingTpl">
            {{ 'auth.resetPassword' | translate }}
          </ng-container>
          <ng-template #loadingTpl>Resetting...</ng-template>
        </button>

        <div class="divider"><span>or</span></div>

        <div class="bottom">
          <span>Back to</span>
          <a routerLink="/auth/login" class="link strong pb-0">{{ 'auth.login' | translate }}</a>
        </div>
      </form>

    </div>
  </div>

  <!-- RIGHT: Video/Image -->
  <div class="auth-right" aria-hidden="true">
    <video class="bg-video" autoplay muted loop playsinline preload="auto">
      <source src="assets/videos/bubble.mp4" type="video/mp4" />
    </video>
    <div class="img-layer"></div>
  </div>
</div>
